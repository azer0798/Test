<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>إدارة WassitDZ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #ff4d94; }
        body { background: #f8f9fa; font-family: sans-serif; }
        .card { border-radius: 15px; border: none; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .btn-primary { background: var(--primary); border: none; }
        .btn-primary:hover { background: #e64485; }
        .section-title { color: var(--primary); font-weight: bold; border-bottom: 2px solid #ffeef4; padding-bottom: 10px; margin-bottom: 20px; }
    </style>
</head>
<body class="p-3">

<div class="container" style="max-width: 900px;">
    <h3 class="text-center fw-bold mb-4">لوحة تحكم WassitDZ</h3>

    <div class="card p-4">
        <h5 class="section-title"><i class="fas fa-link"></i> الروابط الرئيسية</h5>
        <form action="/update-settings" method="POST">
            <div class="row g-3">
                <div class="col-md-4">
                    <label class="small fw-bold">رقم الشراء (واتساب)</label>
                    <input type="text" name="buyNowLink" class="form-control" value="<%= settings.buyNowLink %>" placeholder="مثال: 213555000000">
                </div>
                <div class="col-md-4">
                    <label class="small fw-bold">رابط قناة الوساطة</label>
                    <input type="text" name="mediationLink" class="form-control" value="<%= settings.mediationLink %>">
                </div>
                <div class="col-md-4">
                    <label class="small fw-bold">رابط الدعم الفني</label>
                    <input type="text" name="supportLink" class="form-control" value="<%= settings.supportLink %>">
                </div>
                <div class="col-12 mt-3">
                    <button class="btn btn-success w-100 fw-bold">حفظ التغييرات في الروابط</button>
                </div>
            </div>
        </form>
    </div>

    <div class="card p-4">
        <h5 class="section-title"><i class="fas fa-box"></i> الحسابات المعروضة</h5>
        <div class="table-responsive">
            <table class="table align-middle">
                <thead>
                    <tr class="small text-muted">
                        <th>الصورة</th>
                        <th>اسم الحساب</th>
                        <th>السعر</th>
                        <th>إجراءات</th>
                    </tr>
                </thead>
                <tbody>
                    <% accounts.forEach(acc => { %>
                    <tr>
                        <td><img src="<%= acc.imgs[0] %>" width="45" height="45" style="object-fit: cover; border-radius: 8px;"></td>
                        <td>
                            <form action="/edit-account/<%= acc.id %>" method="POST" class="d-flex gap-1">
                                <input type="text" name="title" class="form-control form-control-sm" value="<%= acc.title %>">
                        </td>
                        <td>
                                <input type="text" name="priceDZ" class="form-control form-control-sm" style="width: 80px;" value="<%= acc.priceDZ %>">
                        </td>
                        <td>
                                <button class="btn btn-sm btn-primary">حفظ</button>
                                <a href="/toggle-status/<%= acc.id %>" class="btn btn-sm <%= acc.status === 'متاح' ? 'btn-success' : 'btn-secondary' %>"><%= acc.status %></a>
                                <a href="/delete-account/<%= acc.id %>" class="btn btn-sm btn-outline-danger" onclick="return confirm('حذف؟')"><i class="fas fa-trash"></i></a>
                            </form>
                        </td>
                    </tr>
                    <% }) %>
                </tbody>
            </table>
        </div>
    </div>

    <div class="card p-4">
        <h5 class="section-title"><i class="fas fa-question-circle"></i> الأسئلة الشائعة</h5>
        <% faqs.forEach(f => { %>
        <form action="/edit-faq/<%= f._id %>" method="POST" class="mb-3 p-2 border rounded shadow-sm bg-white">
            <div class="row g-2">
                <div class="col-md-5">
                    <input type="text" name="question" class="form-control form-control-sm fw-bold" value="<%= f.question %>">
                </div>
                <div class="col-md-5">
                    <input type="text" name="answer" class="form-control form-control-sm text-muted" value="<%= f.answer %>">
                </div>
                <div class="col-md-2 d-flex gap-1">
                    <button class="btn btn-sm btn-primary w-100">حفظ</button>
                    <a href="/delete-faq/<%= f._id %>" class="btn btn-sm btn-danger"><i class="fas fa-times"></i></a>
                </div>
            </div>
        </form>
        <% }) %>
    </div>
</div>

</body>
</html>
